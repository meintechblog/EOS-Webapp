# EOS-Webapp Handover (updated 2026-02-21)

## Current project state

### Infrastructure
- Proxmox VM is running:
  - VMID: `702`
  - Name: `eos-webapp`
  - OS: Debian 13.3
  - CPU/RAM/Disk: 4 vCPU / 8 GB / 40 GB
  - IP: `192.168.3.157`
- Docker + Docker Compose are installed and used as primary runtime.

### Active app mode
- Current functional state is **Slice 10**:
  - HTTP-only setup flow (`/api/setup/*` + `/eos/set/*`)
  - Run-Center with EOS runtime/run history
  - Output processing with HTTP dispatch (scheduled + heartbeat + force)
  - Outputs include a collapsible chart section for time-based run decision visualization
- UI unit policy is fixed for operators:
  - prices in `ct/kWh`
  - capacity in `kWh`
  - power in `kW`
- Legacy channel/mapping/binding/control endpoints are hard removed (not exposed in OpenAPI).
- `/status` no longer exposes an `mqtt` section (strict HTTP-only runtime contract).
- Storage defaults are now:
  - raw `14d`
  - rollup 5m `180d`
  - rollup 1h `1095d`
- Prediction signal persistence is reduced to chart-relevant allowlist keys; full payloads remain in run artifacts.
- Legacy `/optimize` fallback uses persisted warm-start (`start_solution`) from the latest legacy optimize response artifact when available.

### Running services (docker compose)
From `/opt/eos-webapp/infra/docker-compose.yml`:
- `eos` (Akkudoktor EOS) on `8503/8504`
- `postgres` on `5432`
- `backend` on `8080`
- `frontend` app on `3000`

### Reachable URLs
- Frontend app: `http://192.168.3.157:3000`
- Backend API: `http://192.168.3.157:8080`
- Backend status JSON: `http://192.168.3.157:8080/status`
- Live-HTML status pages (`/status/live`, `/stats/live`) removed; use JSON endpoint `http://192.168.3.157:8080/status`.
- EOS API docs: `http://192.168.3.157:8503/docs`
- EOS dashboard: `http://192.168.3.157:8504`

## Repository
- GitHub: `git@github.com:meintechblog/EOS-Webapp.git`
- Branch: `main`

Latest commits:
- `6ede89a` feat: implement slices 2.5-9 (unified setup, run-center, outputs, scheduler)
- `84b3dac` docs(runtime): document dropdown-based mapping UX and payload path
- `0dba7d2` feat(frontend): use eos-field and unit dropdowns in mapping form
- `2e0c35c` feat(api): expose eos field catalog from eos openapi and measurements
- `9823fd7` chore(runtime): log slice-2 proxy cleanup verification

## Core operational endpoints
- Health: `GET /health`
- Runtime status: `GET /status`
- Setup fields/readiness: `GET /api/setup/fields`, `GET /api/setup/readiness`
- Setup setter: `GET /eos/set/{path}`
- EOS runtime/runs: `GET /api/eos/runtime`, `POST /api/eos/runs/force`, `GET /api/eos/runs`
- Outputs: `GET /api/eos/outputs/current`, `GET /api/eos/outputs/timeline`, `GET /api/eos/outputs/events`
- Output dispatch force: `POST /api/eos/outputs/dispatch/force`
- Output target management: `GET/POST/PUT /api/eos/output-targets`

## Local + VM paths
- VM project path: `/opt/eos-webapp`
- Runtime logs/worklog: `/opt/eos-webapp/runtime`

## Notes for next handover
- `README.md` and slice docs in `docs/` are the authoritative runbooks.
- Historical MQTT-era slice docs are archived under `docs/archive/`.
- Unit policy guardrail:
  - `AGENTS.md`
  - `docs/ui-unit-policy.md`
  - `./scripts/check-ui-unit-policy.sh`
